#!/bin/bash
# Script automatically generated by Soplos Packager
# Explicitly set WM_CLASS for Docklike and other docks
export WMCLASS="com.soplos.welcomelive"

# If we're in GTK, we could use GDK_STARTUP_NOTIFICATION_ID
export GDK_STARTUP_NOTIFICATION_ID="${STARTUP_ID:-0}"

# Launch the program with correct application ID
cd /usr/share/soplos-welcome-live

exec python3 -c "
import sys
import os
sys.path.insert(0, '/usr/share/soplos-welcome-live')
os.environ['GDK_STARTUP_ID'] = '${GDK_STARTUP_NOTIFICATION_ID}'
os.environ['WMCLASS'] = 'com.soplos.welcomelive'

import gi
gi.require_version('Gtk', '3.0')
from gi.repository import Gtk, GLib, Gdk

# Set application name before importing modules
GLib.set_prgname('com.soplos.welcomelive')
GLib.set_application_name('soplos-welcome-live')
Gtk.Window.set_default_icon_name('com.soplos.welcomelive')
if hasattr(Gdk, 'set_program_class'):
    Gdk.set_program_class('com.soplos.welcomelive')

# Import and execute main program
import main
try:
    if hasattr(main, 'main'):
        sys.exit(main.main())
    else:
        # Look for a function that could be the entry point
        for attr_name in dir(main):
            if attr_name.lower() in ['main', 'run', 'start']:
                attr = getattr(main, attr_name)
                if callable(attr):
                    sys.exit(attr())
                    break
        else:
            # If there's no main function, just importing is enough
            pass
except Exception as e:
    print(f'Error executing main.py: {e}')
    sys.exit(1)
"
